**Проект спринта "Мастерская_1"**

**Тема "Предсказание стоимости автомобиля на вторичном рынке"**

**Описание проекта**

Многие знают про маркетплейсы где продаются б/у вещи и на которых есть возможность недорого купить качественную и полезную вещь. Но всегда волнует вопрос - кто и как устанавливает цену, и какие его характеристики больше всего влияют на итоговую стоимость продажи?! Вопрос становится особо актуальным, если речь идет про дорогие товары, например про автомобили!<br><br>

Предлагаем принять участие в Мастерской, в рамках которой вы сможете поработать с данными о продажах автомобилей на вторичном рынке. Целью проекта будет разработанная модель предсказания стоимости автомобиля на вторичном рынке.<br>

**Цели и задачи проекта**

Цели проекта:<br>
разработать модель предсказания стоимости автомобиля на вторичном рынке.

Задачи проекта:<br>
загрузка и ознакомление с данными;<br>
предварительная обработка;<br>
полноценный разведочный анализ;<br>
разработка новых синтетических признаков;<br>
проверка на мультиколлинеарность;<br>
отбор финального набора обучающих признаков;<br>
выбор и обучение моделей;<br>
итоговая оценка качества предсказания лучшей модели;<br>
анализ важности ее признаков.

**Содержание проекта**
1. Загрузка файлов с данными и изучение общей информации<br>
Шаг 1.1. Загрузка файлов<br>
Шаг 1.2. Изучение данных<br>
Шаг 1.3. Предобработка данных<br>
Шаг 1.4. Изучение категориальных значений<br>
Шаг 1.5. Проверка количественных значений<br>

2. Разработка модели машинного обучения<br>
Шаг 2.1. One-hot кодирование<br>
Шаг 2.2. Выделение признаков<br>
Шаг 2.3. Масштабирование признаков<br>
Шаг 2.4. Построение моделей<br>

3. Проверка модели<br>
Шаг 3.1. Проверка модели<br>
Шаг 3.2. Сравнение с константной моделью<br>

4. Значимые признаки выбранной модели<br>
Шаг 4. Значимые признаки выбранной модели<br>

5. Общий вывод по проекту<br>
Шаг 5. Общий вывод<br>

**Вывод по проекту**

**Предварительное изучение данных:**

-В датасетах train - 440236 записей, 15 полей, test - 110060 записей, 15 полей.<br>
-В полях 'make', 'model', 'trim', 'body', 'transmission', 'condition', 'odometer', 'color', 'interior' присутствуют пропущенные значения.<br>
-После анализа данных поля 'vin', 'seller', 'saledate' удалены из обучающего и тестового датасетов.<br>
-Для полей 'odometer', 'saledate' изменены типы данных, из поля 'saledate' выделен месяц продажи автомобиля.<br>
-Значения в полях типа object приведены к единому регистру, очищены от лишних пробелов и т.д.<br>
-В отдельные признаки внесены изменения, пустые значения заменены на значение 'nodata', 'trim' - модификации, встречающиеся в совокупности реже 0.001%, объединены в отдельную категорию - other.<br>
-В поле 'condition' пропуски заменены на значение 0 - отсутствие данных.<br>
-Поле 'odometer': медианное значение (52089) меньше среднего (68333), следовательно, данные смещены влево; имеются автомобили как с нулевым, так с очень большим пробегом (999999), большая часть автомобилей имеет пробег ниже среднего. В датасете df_train 0,3% автомобилей имеют пробег менее 10 миль.<br>
-Для поля 'sellingprice' минимальное значение равно 1 усл. ед., среднее - 13592 усл. ед. В датасетах имеются автомобили со стоимостью продажи ниже 100 усл. ед. У большей части таких транспортных средств в поле 'condition' указано значение близкое или равное 1, возможна продажа на детали. Тем не менее необходимы уточнения по данным.<br>
-Ряд полей в датасетах содержит выбросы. Данные выбросы выглядят вполне реалистично, их можно отнести к контекстным выбросам (не удалены).<br>

**Разработка модели ML:**

-При подготовке данных к моделированию выполнено one-hot кодирование категориальные признаков в выборке, масштабирование количественных признаков.<br>
-В выборках выделены признаки (features) и целевой признак (target).<br>
-Для моделирования выбраны три алгоритма решения задач регрессии: 'LinearRegression', 'RandomForestRegressor', 'GradientBoostingRegressor'.<br>
-Для оптимизации модели выбрана метрика MAPE.<br>
-По итогам обучения и тестирования алгоритмов были получены следующие результаты:<br>
--'LinearRegression': MAPE-мера = 4254666.86;<br>
--'RandomForestRegressor': MAPE-мера = 0.29;<br>
--'GradientBoostingRegressor': MAPE-мера = 0.24.<br>
-Итоговой моделью была выбрана модель 'GradientBoostingRegressor' с гиперпараметрами: n_estimators=100, learning_rate=0.1, random_state=12345.<br>

**Проверка модели:**

-Проверка на адекватность итоговой модели с помощью константной модели DummyRegressor показала, что построенная модель GradientBoostingRegressor действительно лучшую производительность, чем константная модель.<br>

**Значимые признаки выбранной модели:**

Наиболее значимые признаки модели:<br>

-пробег в милях;<br>
-год выпуска;<br>
-состояние транспортного средства.
